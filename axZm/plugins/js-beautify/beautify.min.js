/*
  JS Beautifier
  MIT License (MIT)
  Copyright (c) 2007-2013 Einar Lielmanis and contributors.
  Written by Einar Lielmanis, <einar@jsbeautifier.org> http://jsbeautifier.org/
  Originally converted to javascript by Vital, <vital76@gmail.com>
  "End braces on own line" added by Chris J. Shull, <chrisjshull@gmail.com>
  Parsing improvements for brace-less statements by Liam Newman <bitwiseman@gmail.com>
*/

(function(){function E(u,l){return(new X(u,l)).beautify()}function X(u,l){function E(a,c){return{mode:c,last_text:a?a.last_text:"",last_word:a?a.last_word:"",var_line:!1,var_line_tainted:!1,var_line_reindented:!1,in_html_comment:!1,multiline_array:!1,if_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:a?a.indentation_level+(a.var_line&&a.var_line_reindented?1:0):0,ternary_depth:0}}function S(a){for(a=void 0===a?!1:a;m.length&&(" "===m[m.length-1]||m[m.length-
1]===x||m[m.length-1]===F||a&&("\n"===m[m.length-1]||"\r"===m[m.length-1]));)m.pop()}function O(a){return a.replace(/^\s\s*|\s\s*$/,"")}function G(){return m.length&&"\n"===m[m.length-1]}function J(a){a=void 0===a?!1:a;if(g.wrap_line_length&&!a){var c="",c=0;a:{c=m.length-1;0>c&&(c+=m.length);c>m.length-1&&(c=m.length-1);for(c++;0<c--;)if(c in m&&"\n"===m[c])break a;c=-1}c+=1;c<m.length&&(c=m.slice(c).join(""),c=c.length+h.length+(e?1:0),c>=g.wrap_line_length&&(a=!0))}if((g.preserve_newlines&&w||
a)&&!G())d(!1,!0),H=!0,w=!1}function d(b,c){e=H=!1;if(!c&&";"!==a.last_text)for(;a.mode===j.Statement&&!a.if_block;)z();a.mode===j.ArrayLiteral&&(a.multiline_array=!0);m.length&&(b||!G())&&m.push("\n")}function P(b){void 0===b?b=1:"number"!==typeof b&&(b=b?1:0);if(""!==a.last_text)for(var c=0;c<b;c+=1)m.push(x)}function n(b){b=b||h;G()&&(g.keep_array_indentation&&a.mode===j.ArrayLiteral&&A.length?m.push(A.join("")+""):(F&&m.push(F),P(a.indentation_level),P(a.var_line&&a.var_line_reindented),P(H)));
H=!1;if(e&&m.length){var c=m[m.length-1];!G()&&(" "!==c&&c!==x)&&m.push(" ")}e=!1;m.push(b)}function y(b){a?(M.push(a),v=a):v=E(null,b);a=E(v,b)}function K(a){return q(a,[j.ArrayLiteral,j.Expression,j.ForInitializer,j.Conditional])}function z(){0<M.length&&(v=a,a=M.pop())}function Q(){return"do"===a.last_text||"else"===a.last_text&&"if"!==h||"TK_END_EXPR"===f&&(v.mode===j.ForInitializer||v.mode===j.Conditional)?(J(),y(j.Statement),a.indentation_level+=1,H=!1,!0):!1}function L(a){return q(a,"case return do if throw else".split(" "))}
function q(a,c){for(var b=0;b<c.length;b+=1)if(c[b]===a)return!0;return!1}function T(a){for(var c=b,f=k.charAt(c);q(f,R)&&f!==a;){c++;if(c>=s)return!1;f=k.charAt(c)}return f===a}function U(){var p;t=0;if(b>=s)return["","TK_EOF"];w=!1;A=[];var c=k.charAt(b);for(b+=1;q(c,R);){"\n"===c?(t+=1,A=[]):t&&(c===x?A.push(x):"\r"!==c&&A.push(" "));if(b>=s)return["","TK_EOF"];c=k.charAt(b);b+=1}if(q(c,N)){if(b<s)for(;q(k.charAt(b),N)&&!(c+=k.charAt(b),b+=1,b===s););if(b!==s&&c.match(/^[0-9]+[Ee]$/)&&("-"===k.charAt(b)||
"+"===k.charAt(b))){var d=k.charAt(b);b+=1;p=U();c+=d+p[0];return[c,"TK_WORD"]}return"in"===c?[c,"TK_OPERATOR"]:[c,"TK_WORD"]}if("("===c||"["===c)return[c,"TK_START_EXPR"];if(")"===c||"]"===c)return[c,"TK_END_EXPR"];if("{"===c)return[c,"TK_START_BLOCK"];if("}"===c)return[c,"TK_END_BLOCK"];if(";"===c)return[c,"TK_SEMICOLON"];if("/"===c){d="";p=!0;if("*"===k.charAt(b)){b+=1;if(b<s)for(;b<s&&!("*"===k.charAt(b)&&k.charAt(b+1)&&"/"===k.charAt(b+1));){c=k.charAt(b);d+=c;if("\n"===c||"\r"===c)p=!1;b+=1;
if(b>=s)break}b+=2;return p&&0===t?["/*"+d+"*/","TK_INLINE_COMMENT"]:["/*"+d+"*/","TK_BLOCK_COMMENT"]}if("/"===k.charAt(b)){for(d=c;"\r"!==k.charAt(b)&&"\n"!==k.charAt(b)&&!(d+=k.charAt(b),b+=1,b>=s););return[d,"TK_COMMENT"]}}if("'"===c||'"'===c||"/"===c&&("TK_WORD"===f&&L(a.last_text)||"TK_END_EXPR"===f&&q(v.mode,[j.Conditional,j.ForInitializer])||q(f,"TK_COMMENT TK_START_EXPR TK_START_BLOCK TK_END_BLOCK TK_OPERATOR TK_EQUALS TK_EOF TK_SEMICOLON TK_COMMA".split(" ")))){var d=c,e=!1,h=!1;p=c;if(b<
s)if("/"===d)for(c=!1;e||c||k.charAt(b)!==d;){if(p+=k.charAt(b),e?e=!1:(e="\\"===k.charAt(b),"["===k.charAt(b)?c=!0:"]"===k.charAt(b)&&(c=!1)),b+=1,b>=s)return[p,"TK_STRING"]}else for(;e||k.charAt(b)!==d;){p+=k.charAt(b);if(e){if("x"===k.charAt(b)||"u"===k.charAt(b))h=!0;e=!1}else e="\\"===k.charAt(b);b+=1;if(b>=s)return[p,"TK_STRING"]}b+=1;p+=d;if(h&&g.unescape_strings)a:{c=p;p=!1;for(var e="",h=0,l="",n=0,r;p||h<c.length;)if(r=c.charAt(h),h++,p){p=!1;if("x"===r)l=c.substr(h,2),h+=2;else if("u"===
r)l=c.substr(h,4),h+=4;else{e+="\\"+r;continue}if(!l.match(/^[0123456789abcdefABCDEF]+$/)){p=c;break a}n=parseInt(l,16);if(0<=n&&32>n)e="x"===r?e+("\\x"+l):e+("\\u"+l);else if(34===n||39===n||92===n)e+="\\"+String.fromCharCode(n);else if("x"===r&&126<n&&255>=n){p=c;break a}else e+=String.fromCharCode(n)}else"\\"===r?p=!0:e+=r;p=e}if("/"===d)for(;b<s&&q(k.charAt(b),N);)p+=k.charAt(b),b+=1;return[p,"TK_STRING"]}if("#"===c){if(0===m.length&&"!"===k.charAt(b)){for(p=c;b<s&&"\n"!==c;)c=k.charAt(b),p+=
c,b+=1;return[O(p)+"\n","TK_UNKNOWN"]}d="#";if(b<s&&q(k.charAt(b),V)){do c=k.charAt(b),d+=c,b+=1;while(b<s&&"#"!==c&&"="!==c);"#"!==c&&("["===k.charAt(b)&&"]"===k.charAt(b+1)?(d+="[]",b+=2):"{"===k.charAt(b)&&"}"===k.charAt(b+1)&&(d+="{}",b+=2));return[d,"TK_WORD"]}}if("<"===c&&"\x3c!--"===k.substring(b-1,b+3)){b+=3;for(c="\x3c!--";"\n"!==k.charAt(b)&&b<s;)c+=k.charAt(b),b++;a.in_html_comment=!0;return[c,"TK_COMMENT"]}if("-"===c&&a.in_html_comment&&"--\x3e"===k.substring(b-1,b+2))return a.in_html_comment=
!1,b+=2,["--\x3e","TK_COMMENT"];if("."===c)return[c,"TK_DOT"];if(q(c,B)){for(;b<s&&q(c+k.charAt(b),B)&&!(c+=k.charAt(b),b+=1,b>=s););return","===c?[c,"TK_COMMA"]:"="===c?[c,"TK_EQUALS"]:[c,"TK_OPERATOR"]}return[c,"TK_UNKNOWN"]}var k,m,h,C,f,I,x,a,v,M,R,N,B,b,D,V,r,w,t,H,e,A,s,W,j,g,F="";R=["\n","\r","\t"," "];N="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split("");V="0123456789".split("");B="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::";
B+=" <%= <% %> <?= <? ?>";B=B.split(" ");D="continue try throw return var if switch case default for while break function".split(" ");j={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"};W={TK_START_EXPR:function(){Q();if("["===h){if("TK_WORD"===f||")"===a.last_text){q(a.last_text,D)&&(e=!0);y(j.Expression);n();return}if(a.mode===j.ArrayLiteral&&("["===a.last_text||
"]"===I&&","===a.last_text))g.keep_array_indentation||d()}else"for"===a.last_text?y(j.ForInitializer):q(a.last_text,["if","while"])?y(j.Conditional):y(j.Expression);if(";"===a.last_text||"TK_START_BLOCK"===f)d();else if("TK_END_EXPR"===f||"TK_START_EXPR"===f||"TK_END_BLOCK"===f||"."===a.last_text)w&&d();else if("TK_WORD"!==f&&"TK_OPERATOR"!==f)e=!0;else if("function"===a.last_word||"typeof"===a.last_word)g.jslint_happy&&(e=!0);else if(q(a.last_text,D)||"catch"===a.last_text)g.space_before_conditional&&
(e=!0);"("===h&&("TK_EQUALS"===f||"TK_OPERATOR"===f)&&a.mode!==j.ObjectLiteral&&J();n();"["===h&&(y(j.ArrayLiteral),a.indentation_level+=1)},TK_END_EXPR:function(){for(;a.mode===j.Statement;)z();"]"===h&&(a.mode===j.ArrayLiteral&&a.multiline_array&&!g.keep_array_indentation)&&d();z();n();a.do_while&&v.mode===j.Conditional&&(v.mode=j.Expression,a.do_block=!1,a.do_while=!1)},TK_START_BLOCK:function(){y(j.BlockStatement);var b=T("}");"expand-strict"===g.brace_style?b||d():"expand"===g.brace_style?"TK_OPERATOR"!==
f&&("TK_EQUALS"===f||L(a.last_text)&&"else"!==a.last_text?e=!0:d()):"TK_OPERATOR"!==f&&"TK_START_EXPR"!==f?"TK_START_BLOCK"===f?d():e=!0:v.mode===j.ArrayLiteral&&","===a.last_text&&("}"===I?e=!0:d());n();a.indentation_level+=1},TK_END_BLOCK:function(){for(;a.mode===j.Statement;)z();z();"expand"===g.brace_style||"expand-strict"===g.brace_style?"TK_START_BLOCK"!==f&&d():"TK_START_BLOCK"!==f&&(a.mode===j.ArrayLiteral&&g.keep_array_indentation?(g.keep_array_indentation=!1,d(),g.keep_array_indentation=
!0):d());n()},TK_WORD:function(){Q()||w&&(!K(a.mode)&&("TK_OPERATOR"!==f||"--"===a.last_text||"++"===a.last_text)&&"TK_EQUALS"!==f&&(g.preserve_newlines||"var"!==a.last_text))&&d();if(a.do_block&&!a.do_while){if("while"===h){e=!0;n();e=!0;a.do_while=!0;return}d();a.do_block=!1}if(a.if_block&&"else"!==h){for(;a.mode===j.Statement;)z();a.if_block=!1}if("function"===h){a.var_line&&"TK_EQUALS"!==f&&(a.var_line_reindented=!0);if((G()||";"===a.last_text)&&"{"!==a.last_text&&"TK_BLOCK_COMMENT"!==f&&"TK_COMMENT"!==
f){t=G()?t:0;g.preserve_newlines||(t=1);for(var b=0;b<2-t;b++)d(!0)}"TK_WORD"===f?"get"===a.last_text||"set"===a.last_text||"new"===a.last_text||"return"===a.last_text?e=!0:d():"TK_OPERATOR"===f||"="===a.last_text?e=!0:K(a.mode)||d();n();a.last_word=h}else if("case"===h||"default"===h&&a.in_case_statement)d(),a.case_body&&(a.indentation_level--,a.case_body=!1),n(),a.in_case=!0,a.in_case_statement=!0;else{r="NONE";"TK_END_BLOCK"===f?q(h,["else","catch","finally"])?"expand"===g.brace_style||"end-expand"===
g.brace_style||"expand-strict"===g.brace_style?r="NEWLINE":(r="SPACE",e=!0):r="NEWLINE":"TK_SEMICOLON"===f&&a.mode===j.BlockStatement?r="NEWLINE":"TK_SEMICOLON"===f&&K(a.mode)?r="SPACE":"TK_STRING"===f?r="NEWLINE":"TK_WORD"===f?r="SPACE":"TK_START_BLOCK"===f?r="NEWLINE":"TK_END_EXPR"===f&&(e=!0,r="NEWLINE");q(h,D)&&")"!==a.last_text&&(r="else"===a.last_text?"SPACE":"NEWLINE");("TK_COMMA"===f||"TK_START_EXPR"===f||"TK_EQUALS"===f||"TK_OPERATOR"===f)&&a.mode!==j.ObjectLiteral&&J();if(q(h,["else","catch",
"finally"]))"TK_END_BLOCK"!==f||"expand"===g.brace_style||"end-expand"===g.brace_style||"expand-strict"===g.brace_style?d():(S(!0),"}"!==m[m.length-1]&&d(),e=!0);else if("NEWLINE"===r)if(L(a.last_text))e=!0;else if("TK_END_EXPR"!==f){if(("TK_START_EXPR"!==f||"var"!==h)&&":"!==a.last_text)"if"===h&&"else"===a.last_word&&"{"!==a.last_text?e=!0:(a.var_line=!1,a.var_line_reindented=!1,d())}else q(h,D)&&")"!==a.last_text&&(a.var_line=!1,a.var_line_reindented=!1,d());else a.mode===j.ArrayLiteral&&","===
a.last_text&&"}"===I?d():"SPACE"===r&&(e=!0);n();a.last_word=h;"var"===h&&(a.var_line=!0,a.var_line_reindented=!1,a.var_line_tainted=!1);"do"===h&&(a.do_block=!0);"if"===h&&(a.if_block=!0)}},TK_SEMICOLON:function(){for(;a.mode===j.Statement&&!a.if_block;)z();n();a.var_line=!1;a.var_line_reindented=!1;a.mode===j.ObjectLiteral&&(a.mode=j.BlockStatement)},TK_STRING:function(){Q()?e=!0:"TK_WORD"===f?e=!0:"TK_COMMA"===f||"TK_START_EXPR"===f||"TK_EQUALS"===f||"TK_OPERATOR"===f?a.mode!==j.ObjectLiteral&&
J():d();n()},TK_EQUALS:function(){a.var_line&&(a.var_line_tainted=!0);e=!0;n();e=!0},TK_OPERATOR:function(){var b=!0,c=!0;L(a.last_text)?(e=!0,n()):"*"===h&&"TK_DOT"===f&&!I.match(/^\d+$/)?n():":"===h&&a.in_case?(a.case_body=!0,a.indentation_level+=1,n(),d(),a.in_case=!1):"::"===h?n():(w&&("--"===h||"++"===h)&&d(),q(h,["--","++","!"])||q(h,["-","+"])&&(q(f,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||q(a.last_text,D)||","===a.last_text)?(c=b=!1,";"===a.last_text&&K(a.mode)&&(b=!0),
"TK_WORD"===f&&q(a.last_text,D)&&(b=!0),(a.mode===j.BlockStatement||a.mode===j.Statement)&&("{"===a.last_text||";"===a.last_text)&&d()):":"===h?0===a.ternary_depth?(a.mode===j.BlockStatement&&(a.mode=j.ObjectLiteral),b=!1):a.ternary_depth-=1:"?"===h&&(a.ternary_depth+=1),e=e||b,n(),e=c)},TK_COMMA:function(){if(a.var_line){if(K(a.mode)||"TK_END_BLOCK"===f)a.var_line_tainted=!1;a.var_line&&(a.var_line_reindented=!0);n();a.var_line_tainted?(a.var_line_tainted=!1,d()):e=!0}else"TK_END_BLOCK"===f&&a.mode!==
j.Expression?(n(),a.mode===j.ObjectLiteral&&"}"===a.last_text?d():e=!0):a.mode===j.ObjectLiteral?(n(),d()):(n(),e=!0)},TK_BLOCK_COMMENT:function(){for(var a=h,a=a.replace(/\x0d/g,""),b=[],g=a.indexOf("\n");-1!==g;)b.push(a.substring(0,g)),a=a.substring(g+1),g=a.indexOf("\n");a.length&&b.push(a);a:{a=b.slice(1);for(g=0;g<a.length;g++)if("*"!==O(a[g]).charAt(0)){a=!1;break a}a=!0}if(a){d(!1,!0);n(b[0]);for(a=1;a<b.length;a++)d(!1,!0),n(" "+O(b[a]))}else{1<b.length?d(!1,!0):"TK_END_BLOCK"===f?d(!1,!0):
e=!0;n(b[0]);m.push("\n");for(a=1;a<b.length;a++)m.push(b[a]),m.push("\n")}T("\n")||d(!1,!0)},TK_INLINE_COMMENT:function(){e=!0;n();e=!0},TK_COMMENT:function(){w&&d(!1,!0);","===a.last_text&&!w&&S(!0);e=!0;n();d(!1,!0)},TK_DOT:function(){L(a.last_text)?e=!0:J(")"===a.last_text&&g.break_chained_methods);n()},TK_UNKNOWN:function(){n();"\n"===h[h.length-1]&&d()}};l=l?l:{};g={};void 0!==l.space_after_anon_function&&void 0===l.jslint_happy&&(l.jslint_happy=l.space_after_anon_function);void 0!==l.braces_on_own_line&&
(g.brace_style=l.braces_on_own_line?"expand":"collapse");g.brace_style=l.brace_style?l.brace_style:g.brace_style?g.brace_style:"collapse";g.indent_size=l.indent_size?parseInt(l.indent_size,10):4;g.indent_char=l.indent_char?l.indent_char:" ";g.preserve_newlines=void 0===l.preserve_newlines?!0:l.preserve_newlines;g.break_chained_methods=void 0===l.break_chained_methods?!1:l.break_chained_methods;g.max_preserve_newlines=void 0===l.max_preserve_newlines?0:parseInt(l.max_preserve_newlines,10);g.jslint_happy=
void 0===l.jslint_happy?!1:l.jslint_happy;g.keep_array_indentation=void 0===l.keep_array_indentation?!1:l.keep_array_indentation;g.space_before_conditional=void 0===l.space_before_conditional?!0:l.space_before_conditional;g.unescape_strings=void 0===l.unescape_strings?!1:l.unescape_strings;g.wrap_line_length=void 0===l.wrap_line_length?0:parseInt(l.wrap_line_length,10);for(x="";0<g.indent_size;)x+=g.indent_char,g.indent_size-=1;for(;u&&(" "===u.charAt(0)||"\t"===u.charAt(0));)F+=u.charAt(0),u=u.substring(1);
k=u;s=u.length;f="TK_START_BLOCK";I="";m=[];e=H=!1;A=[];M=[];y(j.BlockStatement);b=0;this.beautify=function(){for(var b;;){b=U();h=b[0];C=b[1];if("TK_EOF"===C)break;if(b=g.keep_array_indentation&&a.mode===j.ArrayLiteral)for(b=0;b<t;b+=1)d(!0);else if(w=0<t,g.max_preserve_newlines&&t>g.max_preserve_newlines&&(t=g.max_preserve_newlines),g.preserve_newlines&&1<t){d();for(b=1;b<t;b+=1)d(!0)}W[C]();"TK_INLINE_COMMENT"!==C&&("TK_COMMENT"!==C&&"TK_UNKNOWN"!==C)&&(I=a.last_text,f=C,a.last_text=h)}return F+
m.join("").replace(/[\r\n ]+$/,"")}}"function"===typeof define?define(function(u,l){l.js_beautify=E}):"undefined"!==typeof exports?exports.js_beautify=E:"undefined"!==typeof window&&(window.js_beautify=E)})();